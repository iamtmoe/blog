(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{499:function(s,t,a){"use strict";a.r(t);var n=a(12),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"pm2éƒ¨ç½²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2éƒ¨ç½²"}},[s._v("#")]),s._v(" pm2éƒ¨ç½²")]),s._v(" "),a("h2",{attrs:{id:"èƒŒæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#èƒŒæ™¯"}},[s._v("#")]),s._v(" èƒŒæ™¯")]),s._v(" "),a("p",[s._v("å·¥ä½œä¸­è¦éƒ¨ç½²ä¸€ä¸ªnodeå†™çš„tcpæœåŠ¡ï¼Œå°è¯•äº†éƒ¨ç½²åœ¨k8sé‡Œé¢ï¼Œç«¯å£ä¸é€šï¼Œæ—¶é—´ç´§è¿«å°±å…ˆæ”¹ç”¨ä¼ ç»Ÿæ–¹å¼éƒ¨ç½²ã€‚åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œè¦éƒ¨ç½²æµ‹è¯•å’Œæ­£å¼ä¸¤ä¸ªæœåŠ¡ã€‚")]),s._v(" "),a("h2",{attrs:{id:"é…ç½®æ–‡ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®æ–‡ä»¶"}},[s._v("#")]),s._v(" é…ç½®æ–‡ä»¶")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  apps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcp_server'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// masteråˆ†æ”¯æ”¹ä¸ºtcp_server_prod")]),s._v("\n    script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node server.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Options reference: https://pm2.keymetrics.io/docs/usage/application-declaration/")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// args: 'one two',")]),s._v("\n    instances"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    autorestart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    watch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    max_memory_restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1G'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    env"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'development'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    env_production"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'production'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n  deploy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    development "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      ref  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'origin/dev'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/srv/tcp_server'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pre-deploy-local'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'post-deploy'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'npm install && pm2 reload ecosystem.config.js --env development'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pre-setup'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    production "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      ref  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'origin/master'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      repo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/srv/tcp_server_prod'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pre-deploy-local'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'post-deploy'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'npm install && pm2 reload ecosystem.config.js --env production'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pre-setup'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"éƒ¨ç½²å‘½ä»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²å‘½ä»¤"}},[s._v("#")]),s._v(" éƒ¨ç½²å‘½ä»¤")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("pm2 deploy ecosystem.config.js development setup\npm2 deploy ecosystem.config.js development\n")])])]),a("h2",{attrs:{id:"ä¸€äº›é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€äº›é—®é¢˜"}},[s._v("#")]),s._v(" ä¸€äº›é—®é¢˜")]),s._v(" "),a("h3",{attrs:{id:"sshå…å¯†-åˆ«åç™»å½•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sshå…å¯†-åˆ«åç™»å½•"}},[s._v("#")]),s._v(" sshå…å¯† & åˆ«åç™»å½•")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#åˆ«å")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Host åˆ«å\\n Hostname <ip>\\n User <username>'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ~/.ssh/config\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å…å¯†")]),s._v("\nssh-copy-id åˆ«å "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#æˆ–è€…")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" ~/.ssh/id_rsa.pub user@host:~/.ssh/authorizes_keys\n")])])]),a("h3",{attrs:{id:"æŠ¥é”™pm2-npm-yarn-nodeæ‰¾ä¸åˆ°çš„è§£å†³æ–¹æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŠ¥é”™pm2-npm-yarn-nodeæ‰¾ä¸åˆ°çš„è§£å†³æ–¹æ³•"}},[s._v("#")]),s._v(" æŠ¥é”™pm2/npm/yarn/nodeæ‰¾ä¸åˆ°çš„è§£å†³æ–¹æ³•")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://segmentfault.com/q/1010000013392948",target:"_blank",rel:"noopener noreferrer"}},[s._v("å‚è€ƒé“¾æ¥"),a("OutboundLink")],1),s._v("\nå°†å‘½ä»¤ä»å®é™…ä½ç½®è½¯é“¾æ¥åˆ°/usr/bin")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("whereis")]),s._v(" pm2\npm2: /opt/nodejs/bin/pm2\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /opt/nodejs/bin/pm2 /usr/bin/pm2\n")])])]),a("h3",{attrs:{id:"æ¯æ¬¡æäº¤åéƒ¨ç½²æ‹‰ä¸åˆ°æœ€æ–°ä»£ç "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¯æ¬¡æäº¤åéƒ¨ç½²æ‹‰ä¸åˆ°æœ€æ–°ä»£ç "}},[s._v("#")]),s._v(" æ¯æ¬¡æäº¤åéƒ¨ç½²æ‹‰ä¸åˆ°æœ€æ–°ä»£ç ")]),s._v(" "),a("p",[s._v("æœäº†ä¸‹æ˜¯æœåŠ¡å™¨gitç‰ˆæœ¬é—®é¢˜: "),a("a",{attrs:{href:"https://github.com/Unitech/pm2/issues/2935",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/Unitech/pm2/issues/2935"),a("OutboundLink")],1),a("br"),s._v("\näºæ˜¯é‡æ–°å®‰è£…git: "),a("a",{attrs:{href:"https://www.cnblogs.com/wxwgk/p/11983253.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/wxwgk/p/11983253.html"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --version\nyum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" curl-devel expat-devel gettext-devel openssl-devel zlib-devel asciidoc "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  gcc perl-ExtUtils-MakeMaker\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/src/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O git.zip https://github.com/git/git/releases/tag/v2.33.0\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" git.zip\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" git-master\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/git all\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("prefix")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/git "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export PATH='),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(':/usr/local/git/bin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --version\n")])])]),a("p",[s._v("è¿™é‡Œå¯èƒ½wgetä¸‹è½½ä¸åˆ°gitçš„å‹ç¼©åŒ…ï¼Œå¯ä»¥æµè§ˆå™¨è®¿é—®ä¸‹è½½ğŸ˜‚å†scpåˆ°æœåŠ¡å™¨ä¸Š")])])}),[],!1,null,null,null);t.default=e.exports}}]);