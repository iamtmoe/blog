(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{498:function(s,t,a){"use strict";a.r(t);var e=a(12),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"pgæŸ¥è¯¢ä¼˜åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pgæŸ¥è¯¢ä¼˜åŒ–"}},[s._v("#")]),s._v(" pgæŸ¥è¯¢ä¼˜åŒ–")]),s._v(" "),a("h2",{attrs:{id:"èƒŒæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#èƒŒæ™¯"}},[s._v("#")]),s._v(" èƒŒæ™¯")]),s._v(" "),a("p",[s._v("ä¸Šæ¬¡è°ˆåˆ°æ•°æ®åº“å‹æµ‹è¯æ˜çº¿ä¸Šå¹¶å‘è¿æ¥å‹åŠ›å¯¼è‡´æ•°æ®åº“å˜æ…¢äº†ï¼Œè¿™æ¬¡è°ˆè°ˆæ€ä¹ˆä¼˜åŒ–çš„ã€‚ä¸»è¦æ¶‰åŠåˆ°çš„æŸ¥è¯¢æ˜¯")]),s._v(" "),a("p",[a("code",[s._v("select * from tables where tables.columns = value limit 100 offset 0;")])]),s._v(" "),a("p",[s._v("æ•°æ®åº“çš„ä¼˜åŒ–å¯ä»¥ä»å‡ ä¸ªæ–¹é¢è¿›è¡Œï¼š")]),s._v(" "),a("ul",[a("li",[s._v("æå‡æœåŠ¡å™¨ç¡¬ä»¶é…ç½®")]),s._v(" "),a("li",[s._v("æ›´æ”¹æ•°æ®åº“é…ç½®")]),s._v(" "),a("li",[s._v("å»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œä»£ç é…åˆä½¿æŸ¥è¯¢ç”¨åˆ°ç´¢å¼•")])]),s._v(" "),a("p",[s._v("è¿™æ¬¡ä¸»è¦æ˜¯è®²ç¬¬ä¸‰ç§")]),s._v(" "),a("h2",{attrs:{id:"index-only-scan"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#index-only-scan"}},[s._v("#")]),s._v(" index-only scan")]),s._v(" "),a("p",[s._v("index-only scanæ˜¯æŒ‡åœ¨ç´¢å¼•ä¸­å°±èƒ½æŸ¥åˆ°æ‰€éœ€çš„æ•°æ®ï¼Œä¸éœ€è¦æŸ¥è¡¨ï¼Œindex-only scanè¦æ±‚select,where,orderå‡ºç°çš„å­—æ®µéƒ½å‡ºç°åœ¨ç´¢å¼•é‡Œã€‚æ‰€ä»¥å»ºç«‹ç»„åˆç´¢å¼•")]),s._v(" "),a("p",[a("code",[s._v("create index index_tabels_on_fields1_and_fields_2 on schema.tables (field1, field2) [using btree] include (field3, field4)")])]),s._v(" "),a("p",[s._v("pg é»˜è®¤ä½¿ç”¨btreeç´¢å¼•æ‰€ä»¥å¯ä»¥çœç•¥, filed1, field2æ”¾åˆ°keyä¸Šç”¨äºå®šä½ç´¢å¼•ï¼Œfield3ã€field4æ”¾åˆ°includeé‡Œï¼ˆåªå­˜åœ¨äºå¶å­èŠ‚ç‚¹é‡Œï¼‰ï¼Œè¿™æ ·æŸ¥è¯¢ç§å¦‚æœåªæ¶‰åŠç€å››ä¸ªå­—æ®µå°±å¯ä»¥ä½¿ç”¨index-only scanäº†ã€‚")]),s._v(" "),a("p",[s._v("ä½†æ˜¯æˆ‘ä»¬çš„ä»£ç é‡Œè¦æ‹¿åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œæ‰€ä»¥æŸ¥è¯¢åšäº†å˜é€š")]),s._v(" "),a("p",[a("code",[s._v("select * from tables where tables.id in (select id from tables where tables.field1 = value limit 100 offset 0)")])]),s._v(" "),a("p",[s._v("è¿™æ ·å­æŸ¥è¯¢å°±å¯ä»¥ä½¿ç”¨index-only scanï¼Œåˆ†é¡µåæ‹¿åˆ°ç¬¬ä¸€é¡µçš„idï¼Œå†é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥åˆ°ç¬¬ä¸€é¡µçš„æ•°æ®")]),s._v(" "),a("p",[s._v("ä»¥ä¸ŠåŸºæœ¬ä¸Šå¤§éƒ¨åˆ†æŸ¥è¯¢æ…¢çš„é—®é¢˜å°±è§£å†³äº†")]),s._v(" "),a("h2",{attrs:{id:"elastic-search"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elastic-search"}},[s._v("#")]),s._v(" Elastic Search")]),s._v(" "),a("p",[s._v("æœ‰ä¸ªéœ€è¦æ¨¡ç³ŠæŸ¥è¯¢çš„æ–‡æœ¬å­—æ®µï¼Œå› ä¸ºäº§å“å±‚é¢æ²¡åšå­—æ•°é™åˆ¶éƒ¨åˆ†æ•°æ®å¤ªå¤§å»ºä¸äº†ç´¢å¼•ï¼Œå€’æ˜¯å¯ä»¥å»ºéƒ¨åˆ†å•åˆ—ç´¢å¼•")]),s._v(" "),a("p",[a("code",[s._v("create index index_tables_on_fields on tables (field) where length(field) < 500;")])]),s._v(" "),a("p",[s._v("ä½†æ˜¯æ²¡ä»€ä¹ˆåµç”¨ï¼Œå•åˆ—ç´¢å¼•è¿˜æ˜¯æ…¢ï¼Œå°è¯•ä½¿ç”¨æ’ä»¶")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" EXTENSION pg_trgm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" index_tables_on_field "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USING")]),s._v(" gin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field gin_trgm_ops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("ä¾ç„¶æ²¡ä»€ä¹ˆåµç”¨ï¼Œçœ‹æŸ¥è¯¢è®¡åˆ’pgæ ¹æœ¬ä¸ç”¨å®ƒã€‚\næ²¡åŠæ³•æœ€åé€šè¿‡"),a("code",[s._v("elastic search")]),s._v("æŸ¥å‡ºidè¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢")]),s._v(" "),a("p",[a("code",[s._v("{ match: { field: value } }")])]),s._v(" "),a("h2",{attrs:{id:"json-field"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-field"}},[s._v("#")]),s._v(" json field")]),s._v(" "),a("p",[s._v("æ¶‰åŠè¡¨é‡Œçš„jsonå­—æ®µæœç´¢ï¼Œæœ‰çš„æšä¸¾å€¼æ•°æ®åˆ†å¸ƒå¾ˆé›†ä¸­ï¼Œå•åˆ—ç´¢å¼•ä¸ç®¡ç”¨ï¼Œjsonå­—æ®µä¹Ÿæ”¾ä¸åˆ°å¤åˆç´¢å¼•é‡Œï¼Œæœ€åæŠŠè¿™äº›å­—æ®µåŒæ­¥åˆ°å¦ä¸€ä¸ªmongoåº“é‡Œï¼ŒæŸ¥å‡ºidå†è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢")]),s._v(" "),a("h2",{attrs:{id:"äºŒæ¬¡æŸ¥è¯¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒæ¬¡æŸ¥è¯¢"}},[s._v("#")]),s._v(" äºŒæ¬¡æŸ¥è¯¢")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("analyze")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"field"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tables"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ids"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DESC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFFSET")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n")])])]),a("p",[s._v("è¿™é‡Œçš„(ids)æ˜¯ç¬¬ä¸€æ¬¡æŸ¥è¯¢æŸ¥å‡ºæ¥çš„ï¼Œæœ¬ä»¥ä¸ºäºŒæ¬¡æŸ¥è¯¢ä¼šèµ°index-only scanï¼Œäº‹å®æ˜¯å½“idæ•°é‡å¾ˆå¤§çš„æ—¶å€™æŸ¥è¯¢åˆ†æå™¨å¯¹äºå­æŸ¥è¯¢è¿˜æ˜¯é€‰æ‹©äº†"),a("code",[s._v("bitmap heap scan")]),s._v("(åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹~ğŸ˜‚)ï¼Œè¯•äº†ä¸€ä¸‹"),a("code",[s._v("set enable_bitmapscan to off")]),s._v("ï¼Œå±…ç„¶å¯ä»¥"),a("code",[s._v("index-only scan")]),s._v("äº†ğŸ‰ï¼Œæ‰€ä»¥æœ€ååœ¨æ¯æ¬¡æŸ¥è¯¢å‰å…ˆæ‰§è¡Œè¿™ä¸€å¥ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("#")]),s._v(" æ€»ç»“")]),s._v(" "),a("p",[s._v("é¡¶ç€å‹åŠ›å„ç§hackæš‚æ—¶è§£å†³äº†é—®é¢˜ã€‚å‰‘èµ°åé”‹ï¼Œå®å±æ— å¥ˆä¹‹ä¸¾;æ­£å¥‡ç›¸åˆï¼Œæ–¹ä¸ºé•¿ä¹…ä¹‹é“ã€‚")]),s._v(" "),a("h2",{attrs:{id:"å¸¸ç”¨sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¸¸ç”¨sql"}},[s._v("#")]),s._v(" å¸¸ç”¨sql")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- è¿æ¥æ•°")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" datname "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_stat_activity "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" datname "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" c "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- æ…¢æŸ¥è¯¢")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("distinct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" query "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_stat_activity "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'idle'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" pg_stat_activity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query_start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2s'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ç´¢å¼•åˆ—è¡¨")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" indexname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" indexdef "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_indexes "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" tablename "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tables'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ç´¢å¼•å¤§å°")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" pg_relation_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'index_tables_on_field'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- åˆ é™¤ç´¢å¼•")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("exists")]),s._v(" index_tables_on_field"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- è®¾ç½®å‚æ•°")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" enable_bitmapscan "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- json fieldåˆ›å»ºéƒ¨åˆ†ç´¢å¼•")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" index_tables_on_field "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jsondoc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'field'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsondoc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'field'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- åˆ›å»ºæ‹“å±•")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" EXTENSION pg_trgm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- æŸ¥çœ‹ä¸Šæ¬¡vacuum")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" relname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("last_vacuum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" last_autovacuum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" last_analyze"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" last_autoanalyze "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_stat_user_tables "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" relname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tables'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- æŸ¥çœ‹æŸ¥è¯¢è®¡åˆ’")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("analyze")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- é”ç›¸å…³")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_locks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" \n    relname "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" relation_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n    pg_locks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pg_locks\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" pg_class "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" pg_locks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relation "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pg_class"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("oid\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" pg_stat_activity "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" pg_locks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pg_stat_activity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"å‚è€ƒé“¾æ¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒé“¾æ¥"}},[s._v("#")]),s._v(" å‚è€ƒé“¾æ¥")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://dba.stackexchange.com/questions/196721/bitmap-heapscan-is-slow",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://dba.stackexchange.com/questions/196721/bitmap-heapscan-is-slow"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cybertec-postgresql.com/en/postgresql-indexing-index-scan-vs-bitmap-scan-vs-sequential-scan-basics/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cybertec-postgresql.com/en/postgresql-indexing-index-scan-vs-bitmap-scan-vs-sequential-scan-basics/"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://pganalyze.com/docs/explain/scan-nodes/bitmap-index-scan",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://pganalyze.com/docs/explain/scan-nodes/bitmap-index-scan"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/3581294/index-key-column-vs-index-included-column",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://stackoverflow.com/questions/3581294/index-key-column-vs-index-included-column"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://use-the-index-luke.com/blog/2019-04/include-columns-in-btree-indexes",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://use-the-index-luke.com/blog/2019-04/include-columns-in-btree-indexes"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.postgresql.org/docs/12/runtime-config-autovacuum.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.postgresql.org/docs/12/runtime-config-autovacuum.html"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.shanelynn.ie/postgresql-find-slow-long-running-and-blocked-queries/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.shanelynn.ie/postgresql-find-slow-long-running-and-blocked-queries/"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://help.aliyun.com/document_detail/281785.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://help.aliyun.com/document_detail/281785.html"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.lob.com/blog/supercharge-your-postgresql-performance",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.lob.com/blog/supercharge-your-postgresql-performance"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/1566717/postgresql-like-query-performance-variations",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://stackoverflow.com/questions/1566717/postgresql-like-query-performance-variations"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://stackoverflow.com/questions/53583257/is-there-a-workaround-to-ensure-index-only-scan-on-jsondoc-equality-que",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://stackoverflow.com/questions/53583257/is-there-a-workaround-to-ensure-index-only-scan-on-jsondoc-equality-que"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);