<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>pgæŸ¥è¯¢ä¼˜åŒ– | ä¸€ä½•æœ‰å°”çš„åšå®¢</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/blog/favicon.ico">
    <link rel="manifest" href="/blog/manifest.json">
    <link rel="apple-touch-icon" href="/blog/images/app_icon/app_icon48.jpeg">
    <link rel="mask-icon" href="/blog/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="
èƒŒæ™¯

ä¸Šæ¬¡è°ˆåˆ°æ•°æ®åº“å‹æµ‹è¯æ˜çº¿ä¸Šå¹¶å‘è¿æ¥å‹åŠ›å¯¼è‡´æ•°æ®åº“å˜æ…¢äº†ï¼Œè¿™æ¬¡è°ˆè°ˆæ€ä¹ˆä¼˜åŒ–çš„ã€‚ä¸»è¦æ¶‰åŠåˆ°çš„æŸ¥è¯¢æ˜¯

select * from tables where tables.columns = value limit 100 offset 0;

æ•°æ®åº“çš„ä¼˜åŒ–å¯ä»¥ä»å‡ ä¸ªæ–¹é¢è¿›è¡Œï¼š

æå‡æœåŠ¡å™¨ç¡¬ä»¶é…ç½®
æ›´æ”¹æ•°æ®åº“é…ç½®
å»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œä»£ç é…åˆä½¿æŸ¥è¯¢ç”¨åˆ°ç´¢å¼•

è¿™æ¬¡ä¸»è¦æ˜¯è®² ...">
    <meta name="baidu-site-verification" content="41GlPEeYTk">
    <meta name="keywords" content="vuepress, blog, ä¸€ä½•æœ‰å°”">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/images/app_icon/app_icon48.jpeg">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/blog/assets/css/0.styles.db20579b.css" as="style"><link rel="preload" href="/blog/assets/js/app.c616dceb.js" as="script"><link rel="preload" href="/blog/assets/js/6.b5d332af.js" as="script"><link rel="preload" href="/blog/assets/js/3.749e8baa.js" as="script"><link rel="preload" href="/blog/assets/js/26.31632e5f.js" as="script"><link rel="preload" href="/blog/assets/js/8.050f5748.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.aa1dac21.js"><link rel="prefetch" href="/blog/assets/js/11.70c977ba.js"><link rel="prefetch" href="/blog/assets/js/12.bca8c580.js"><link rel="prefetch" href="/blog/assets/js/13.b618ec97.js"><link rel="prefetch" href="/blog/assets/js/14.80ae0e92.js"><link rel="prefetch" href="/blog/assets/js/15.1e8d5c02.js"><link rel="prefetch" href="/blog/assets/js/16.9fcef108.js"><link rel="prefetch" href="/blog/assets/js/17.60290ab1.js"><link rel="prefetch" href="/blog/assets/js/18.bd9b53f4.js"><link rel="prefetch" href="/blog/assets/js/19.bf170d35.js"><link rel="prefetch" href="/blog/assets/js/20.76d2073a.js"><link rel="prefetch" href="/blog/assets/js/21.84e35001.js"><link rel="prefetch" href="/blog/assets/js/22.9a77eca9.js"><link rel="prefetch" href="/blog/assets/js/23.eee85973.js"><link rel="prefetch" href="/blog/assets/js/24.af56bcfb.js"><link rel="prefetch" href="/blog/assets/js/25.b9c14c5d.js"><link rel="prefetch" href="/blog/assets/js/27.b62c171d.js"><link rel="prefetch" href="/blog/assets/js/28.c6fdb267.js"><link rel="prefetch" href="/blog/assets/js/29.c3073e06.js"><link rel="prefetch" href="/blog/assets/js/30.8fd564e6.js"><link rel="prefetch" href="/blog/assets/js/31.2d770bc9.js"><link rel="prefetch" href="/blog/assets/js/32.a63a63d2.js"><link rel="prefetch" href="/blog/assets/js/33.8bc5dfef.js"><link rel="prefetch" href="/blog/assets/js/34.768a88f4.js"><link rel="prefetch" href="/blog/assets/js/35.07c0faed.js"><link rel="prefetch" href="/blog/assets/js/36.91bb844e.js"><link rel="prefetch" href="/blog/assets/js/4.c95f156b.js"><link rel="prefetch" href="/blog/assets/js/5.1b5f68e5.js"><link rel="prefetch" href="/blog/assets/js/7.833de25a.js"><link rel="prefetch" href="/blog/assets/js/9.5e1c757e.js"><link rel="prefetch" href="/blog/assets/js/vuejs-paginate.c4247c5c.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.db20579b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/blog/" class="nav-link home-link">ä¸€ä½•æœ‰å°”çš„åšå®¢ </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/blog/" class="nav-link">Home</a></li><li class="nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/blog/" class="nav-link mobile-home-link">ä¸€ä½•æœ‰å°”çš„åšå®¢ </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/blog/" class="nav-link">Home</a></li><li class="mobile-nav-item"><a href="/blog/tag/" class="nav-link">Tags</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2021-10-27T00:00:00.000Z">
      Wed Oct 27 2021
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/blog/tag/postgres" data-v-42ccfcd5><span data-v-42ccfcd5>postgres</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h1 id="pgæŸ¥è¯¢ä¼˜åŒ–"><a href="#pgæŸ¥è¯¢ä¼˜åŒ–" class="header-anchor">#</a> pgæŸ¥è¯¢ä¼˜åŒ–</h1> <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="header-anchor">#</a> èƒŒæ™¯</h2> <p>ä¸Šæ¬¡è°ˆåˆ°æ•°æ®åº“å‹æµ‹è¯æ˜çº¿ä¸Šå¹¶å‘è¿æ¥å‹åŠ›å¯¼è‡´æ•°æ®åº“å˜æ…¢äº†ï¼Œè¿™æ¬¡è°ˆè°ˆæ€ä¹ˆä¼˜åŒ–çš„ã€‚ä¸»è¦æ¶‰åŠåˆ°çš„æŸ¥è¯¢æ˜¯</p> <p><code>select * from tables where tables.columns = value limit 100 offset 0;</code></p> <p>æ•°æ®åº“çš„ä¼˜åŒ–å¯ä»¥ä»å‡ ä¸ªæ–¹é¢è¿›è¡Œï¼š</p> <ul><li>æå‡æœåŠ¡å™¨ç¡¬ä»¶é…ç½®</li> <li>æ›´æ”¹æ•°æ®åº“é…ç½®</li> <li>å»ºç«‹åˆé€‚çš„ç´¢å¼•ï¼Œä»£ç é…åˆä½¿æŸ¥è¯¢ç”¨åˆ°ç´¢å¼•</li></ul> <p>è¿™æ¬¡ä¸»è¦æ˜¯è®²ç¬¬ä¸‰ç§</p> <h2 id="index-only-scan"><a href="#index-only-scan" class="header-anchor">#</a> index-only scan</h2> <p>index-only scanæ˜¯æŒ‡åœ¨ç´¢å¼•ä¸­å°±èƒ½æŸ¥åˆ°æ‰€éœ€çš„æ•°æ®ï¼Œä¸éœ€è¦æŸ¥è¡¨ï¼Œindex-only scanè¦æ±‚select,where,orderå‡ºç°çš„å­—æ®µéƒ½å‡ºç°åœ¨ç´¢å¼•é‡Œã€‚æ‰€ä»¥å»ºç«‹ç»„åˆç´¢å¼•</p> <p><code>create index index_tabels_on_fields1_and_fields_2 on schema.tables (field1, field2) [using btree] include (field3, field4)</code></p> <p>pg é»˜è®¤ä½¿ç”¨btreeç´¢å¼•æ‰€ä»¥å¯ä»¥çœç•¥, filed1, field2æ”¾åˆ°keyä¸Šç”¨äºå®šä½ç´¢å¼•ï¼Œfield3ã€field4æ”¾åˆ°includeé‡Œï¼ˆåªå­˜åœ¨äºå¶å­èŠ‚ç‚¹é‡Œï¼‰ï¼Œè¿™æ ·æŸ¥è¯¢ç§å¦‚æœåªæ¶‰åŠç€å››ä¸ªå­—æ®µå°±å¯ä»¥ä½¿ç”¨index-only scanäº†ã€‚</p> <p>ä½†æ˜¯æˆ‘ä»¬çš„ä»£ç é‡Œè¦æ‹¿åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œæ‰€ä»¥æŸ¥è¯¢åšäº†å˜é€š</p> <p><code>select * from tables where tables.id in (select id from tables where tables.field1 = value limit 100 offset 0)</code></p> <p>è¿™æ ·å­æŸ¥è¯¢å°±å¯ä»¥ä½¿ç”¨index-only scanï¼Œåˆ†é¡µåæ‹¿åˆ°ç¬¬ä¸€é¡µçš„idï¼Œå†é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥åˆ°ç¬¬ä¸€é¡µçš„æ•°æ®</p> <p>ä»¥ä¸ŠåŸºæœ¬ä¸Šå¤§éƒ¨åˆ†æŸ¥è¯¢æ…¢çš„é—®é¢˜å°±è§£å†³äº†</p> <h2 id="elastic-search"><a href="#elastic-search" class="header-anchor">#</a> Elastic Search</h2> <p>æœ‰ä¸ªéœ€è¦æ¨¡ç³ŠæŸ¥è¯¢çš„æ–‡æœ¬å­—æ®µï¼Œå› ä¸ºäº§å“å±‚é¢æ²¡åšå­—æ•°é™åˆ¶éƒ¨åˆ†æ•°æ®å¤ªå¤§å»ºä¸äº†ç´¢å¼•ï¼Œå€’æ˜¯å¯ä»¥å»ºéƒ¨åˆ†å•åˆ—ç´¢å¼•</p> <p><code>create index index_tables_on_fields on tables (field) where length(field) &lt; 500;</code></p> <p>ä½†æ˜¯æ²¡ä»€ä¹ˆåµç”¨ï¼Œå•åˆ—ç´¢å¼•è¿˜æ˜¯æ…¢ï¼Œå°è¯•ä½¿ç”¨æ’ä»¶</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> EXTENSION pg_trgm<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_tables_on_field <span class="token keyword">ON</span> <span class="token keyword">tables</span> <span class="token keyword">USING</span> gin <span class="token punctuation">(</span>field gin_trgm_ops<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¾ç„¶æ²¡ä»€ä¹ˆåµç”¨ï¼Œçœ‹æŸ¥è¯¢è®¡åˆ’pgæ ¹æœ¬ä¸ç”¨å®ƒã€‚
æ²¡åŠæ³•æœ€åé€šè¿‡<code>elastic search</code>æŸ¥å‡ºidè¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢</p> <p><code>{ match: { field: value } }</code></p> <h2 id="json-field"><a href="#json-field" class="header-anchor">#</a> json field</h2> <p>æ¶‰åŠè¡¨é‡Œçš„jsonå­—æ®µæœç´¢ï¼Œæœ‰çš„æšä¸¾å€¼æ•°æ®åˆ†å¸ƒå¾ˆé›†ä¸­ï¼Œå•åˆ—ç´¢å¼•ä¸ç®¡ç”¨ï¼Œjsonå­—æ®µä¹Ÿæ”¾ä¸åˆ°å¤åˆç´¢å¼•é‡Œï¼Œæœ€åæŠŠè¿™äº›å­—æ®µåŒæ­¥åˆ°å¦ä¸€ä¸ªmongoåº“é‡Œï¼ŒæŸ¥å‡ºidå†è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢</p> <h2 id="äºŒæ¬¡æŸ¥è¯¢"><a href="#äºŒæ¬¡æŸ¥è¯¢" class="header-anchor">#</a> äºŒæ¬¡æŸ¥è¯¢</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">explain</span> <span class="token keyword">analyze</span> <span class="token keyword">SELECT</span> <span class="token string">&quot;tables&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">&quot;tables&quot;</span> <span class="token keyword">WHERE</span> <span class="token string">&quot;tables&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token string">&quot;tables&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span> <span class="token keyword">FROM</span> <span class="token string">&quot;tables&quot;</span> <span class="token keyword">WHERE</span> <span class="token string">&quot;tables&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;field&quot;</span> <span class="token operator">=</span> <span class="token keyword">value</span> <span class="token operator">AND</span> <span class="token string">&quot;tables&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>ids<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">100</span> <span class="token keyword">OFFSET</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> id <span class="token keyword">DESC</span>
</code></pre></div><p>è¿™é‡Œçš„(ids)æ˜¯ç¬¬ä¸€æ¬¡æŸ¥è¯¢æŸ¥å‡ºæ¥çš„ï¼Œæœ¬ä»¥ä¸ºäºŒæ¬¡æŸ¥è¯¢ä¼šèµ°index-only scanï¼Œäº‹å®æ˜¯å½“idæ•°é‡å¾ˆå¤§çš„æ—¶å€™æŸ¥è¯¢åˆ†æå™¨å¯¹äºå­æŸ¥è¯¢è¿˜æ˜¯é€‰æ‹©äº†<code>bitmap heap scan</code>(åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹~ğŸ˜‚)ï¼Œè¯•äº†ä¸€ä¸‹<code>set enable_bitmapscan to off</code>ï¼Œå±…ç„¶å¯ä»¥<code>index-only scan</code>äº†ğŸ‰ï¼Œæ‰€ä»¥æœ€ååœ¨æ¯æ¬¡æŸ¥è¯¢å‰å…ˆæ‰§è¡Œè¿™ä¸€å¥ã€‚</p> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h2> <p>é¡¶ç€å‹åŠ›å„ç§hackæš‚æ—¶è§£å†³äº†é—®é¢˜ã€‚å‰‘èµ°åé”‹ï¼Œå®å±æ— å¥ˆä¹‹ä¸¾;æ­£å¥‡ç›¸åˆï¼Œæ–¹ä¸ºé•¿ä¹…ä¹‹é“ã€‚</p> <h2 id="å¸¸ç”¨sql"><a href="#å¸¸ç”¨sql" class="header-anchor">#</a> å¸¸ç”¨sql</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- è¿æ¥æ•°</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">,</span> datname <span class="token keyword">from</span> pg_stat_activity <span class="token keyword">group</span> <span class="token keyword">by</span> datname <span class="token keyword">order</span> <span class="token keyword">by</span> c <span class="token keyword">desc</span><span class="token punctuation">;</span>
<span class="token comment">-- æ…¢æŸ¥è¯¢</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> query <span class="token keyword">from</span> pg_stat_activity <span class="token keyword">where</span> state <span class="token operator">!=</span> <span class="token string">'idle'</span> <span class="token operator">and</span>  <span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> pg_stat_activity<span class="token punctuation">.</span>query_start<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token keyword">interval</span> <span class="token string">'2s'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> query<span class="token punctuation">;</span>
<span class="token comment">-- ç´¢å¼•åˆ—è¡¨</span>
<span class="token keyword">select</span> indexname<span class="token punctuation">,</span> indexdef <span class="token keyword">from</span> pg_indexes <span class="token keyword">where</span> tablename <span class="token operator">=</span> <span class="token string">'tables'</span><span class="token punctuation">;</span>
<span class="token comment">-- ç´¢å¼•å¤§å°</span>
<span class="token keyword">select</span> pg_relation_size<span class="token punctuation">(</span><span class="token string">'index_tables_on_field'</span><span class="token punctuation">)</span>
<span class="token comment">-- åˆ é™¤ç´¢å¼•</span>
<span class="token keyword">drop</span> <span class="token keyword">index</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> index_tables_on_field<span class="token punctuation">;</span>
<span class="token comment">-- è®¾ç½®å‚æ•°</span>
<span class="token keyword">set</span> enable_bitmapscan <span class="token keyword">to</span> <span class="token keyword">on</span><span class="token punctuation">;</span>
<span class="token comment">-- json fieldåˆ›å»ºéƒ¨åˆ†ç´¢å¼•</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> index_tables_on_field <span class="token keyword">on</span> <span class="token keyword">tables</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>jsondoc<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">'field'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token keyword">tables</span><span class="token punctuation">.</span>jsondoc<span class="token operator">-</span><span class="token operator">&gt;&gt;</span><span class="token string">'field'</span> <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>
<span class="token comment">-- åˆ›å»ºæ‹“å±•</span>
<span class="token keyword">CREATE</span> EXTENSION pg_trgm<span class="token punctuation">;</span>
<span class="token comment">-- æŸ¥çœ‹ä¸Šæ¬¡vacuum</span>
<span class="token keyword">select</span> relname<span class="token punctuation">,</span>last_vacuum<span class="token punctuation">,</span> last_autovacuum<span class="token punctuation">,</span> last_analyze<span class="token punctuation">,</span> last_autoanalyze <span class="token keyword">from</span> pg_stat_user_tables <span class="token keyword">where</span> relname <span class="token operator">=</span> <span class="token string">'tables'</span><span class="token punctuation">;</span>
<span class="token comment">-- æŸ¥çœ‹æŸ¥è¯¢è®¡åˆ’</span>
<span class="token keyword">explain</span> <span class="token keyword">analyze</span> <span class="token keyword">select</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">-- é”ç›¸å…³</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> pg_locks<span class="token punctuation">;</span>
<span class="token keyword">select</span> 
    relname <span class="token keyword">as</span> relation_name<span class="token punctuation">,</span> 
    query<span class="token punctuation">,</span> 
    pg_locks<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">from</span> pg_locks
<span class="token keyword">join</span> pg_class <span class="token keyword">on</span> pg_locks<span class="token punctuation">.</span>relation <span class="token operator">=</span> pg_class<span class="token punctuation">.</span>oid
<span class="token keyword">join</span> pg_stat_activity <span class="token keyword">on</span> pg_locks<span class="token punctuation">.</span>pid <span class="token operator">=</span> pg_stat_activity<span class="token punctuation">.</span>pid<span class="token punctuation">;</span>
</code></pre></div><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="header-anchor">#</a> å‚è€ƒé“¾æ¥</h2> <ul><li><a href="https://dba.stackexchange.com/questions/196721/bitmap-heapscan-is-slow" target="_blank" rel="noopener noreferrer">https://dba.stackexchange.com/questions/196721/bitmap-heapscan-is-slow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cybertec-postgresql.com/en/postgresql-indexing-index-scan-vs-bitmap-scan-vs-sequential-scan-basics/" target="_blank" rel="noopener noreferrer">https://www.cybertec-postgresql.com/en/postgresql-indexing-index-scan-vs-bitmap-scan-vs-sequential-scan-basics/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pganalyze.com/docs/explain/scan-nodes/bitmap-index-scan" target="_blank" rel="noopener noreferrer">https://pganalyze.com/docs/explain/scan-nodes/bitmap-index-scan<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://stackoverflow.com/questions/3581294/index-key-column-vs-index-included-column" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/3581294/index-key-column-vs-index-included-column<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://use-the-index-luke.com/blog/2019-04/include-columns-in-btree-indexes" target="_blank" rel="noopener noreferrer">https://use-the-index-luke.com/blog/2019-04/include-columns-in-btree-indexes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.postgresql.org/docs/12/runtime-config-autovacuum.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/12/runtime-config-autovacuum.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.shanelynn.ie/postgresql-find-slow-long-running-and-blocked-queries/" target="_blank" rel="noopener noreferrer">https://www.shanelynn.ie/postgresql-find-slow-long-running-and-blocked-queries/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://help.aliyun.com/document_detail/281785.html" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/document_detail/281785.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.lob.com/blog/supercharge-your-postgresql-performance" target="_blank" rel="noopener noreferrer">https://www.lob.com/blog/supercharge-your-postgresql-performance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://stackoverflow.com/questions/1566717/postgresql-like-query-performance-variations" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/1566717/postgresql-like-query-performance-variations<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://stackoverflow.com/questions/53583257/is-there-a-workaround-to-ensure-index-only-scan-on-jsondoc-equality-que" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/53583257/is-there-a-workaround-to-ensure-index-only-scan-on-jsondoc-equality-que<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#èƒŒæ™¯" title="èƒŒæ™¯">èƒŒæ™¯</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#index-only-scan" title="index-only scan">index-only scan</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#elastic-search" title="Elastic Search">Elastic Search</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#json-field" title="json field">json field</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#äºŒæ¬¡æŸ¥è¯¢" title="äºŒæ¬¡æŸ¥è¯¢">äºŒæ¬¡æŸ¥è¯¢</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#æ€»ç»“" title="æ€»ç»“">æ€»ç»“</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å¸¸ç”¨sql" title="å¸¸ç”¨sql">å¸¸ç”¨sql</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#å‚è€ƒé“¾æ¥" title="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/iamtmoe" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8>Privacy Policy</a></li><li class="copyright-item" data-v-3d9deeb8>MIT Licensed | Copyright Â© ä¸€ä½•æœ‰å°”</li></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.c616dceb.js" defer></script><script src="/blog/assets/js/6.b5d332af.js" defer></script><script src="/blog/assets/js/3.749e8baa.js" defer></script><script src="/blog/assets/js/26.31632e5f.js" defer></script><script src="/blog/assets/js/8.050f5748.js" defer></script>
  </body>
</html>
